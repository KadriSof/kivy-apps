#:import Factory kivy.factory.Factory


<BorderBox@MDFloatLayout>:
    canvas:
        Color:
            rgba: (0, 0, 0, .2)
        Line:
            rectangle: [self.x, self.y, self.width, self.height]
            width: dp(2)


<BorderTextInput@TextInput>:
    background_normal: ''
    background_active: ''
    cursor_color: "grey"
    foreground_color: (0, 0, 0, 1)

    canvas.before:
        Color:
            rgba: (0, 0, 0, .4) if self.focus == True else (0, 0, 0, .2)
        Line:
            rectangle: [self.x, self.y, self.width, self.height]
            width: dp(1)
        Color:
            rgba: (0, 0, 0, 1)

<MySpinner@Spinner>:
    background_normal: 'media/spinner-normal.png'
    background_down: 'media/spinner-down.png'
    values: ['Phone', 'PC', 'Tablet']
    text_size: (self.width, None)
    bold: True
    halign: 'center'
    valign: 'center'
    shorten: True
    color: "dimgray"
    option_cls: Factory.get("MySpinnerOption")

    canvas.before:
        Color:
            rgba: (0, 0, 0, .4) if self.state == 'down' else (0, 0, 0, .2)
        Line:
            rectangle: [self.x, self.y, self.width, self.height]
            width: dp(1)
        Color:
            rgba: (0, 0, 0, 1)

<MySpinnerOption@SpinnerOption>:
    background_color: "lightsteelblue" if self.state == 'down' else "lavender"
    background_normal: ''
    background_down: ''
    color: "darkslategray"
    size_hint_y: None
    height: dp(32)

    canvas:
        Color:
            rgba: (0, 0, 0, .2)
        Line:
            rectangle: [self.x, self.y, self.width, self.height]
            width: dp(1)


<DeviceItemViewModel>:
    canvas:
        Color:
            rgba: (0, 0, 0, .2)
        Line:
            rectangle: [self.x, self.y, self.width, self.height]
            width: dp(1)

    orientation: 'horizontal'
    size_hint_y: None
    height: dp(80)
    padding: dp(10)
    spacing: dp(5)

    MDIconButton:
        size_hint: (.2, 1)
        icon: 'information-box'
        icon_size: dp(32)
        radius: [self.height / 2, ]
        theme_text_color: 'Custom'
        text_color: app.theme_cls.primary_dark
        on_release: root.get_device_info()

    MDBoxLayout:
        orientation: 'vertical'
        size_hint: (.8, 1)
        spacing: dp(2)

        MDLabel:
            text: root.device_name
            theme_text_color: 'Custom'
            font_style: 'Caption'
            text_color: app.theme_cls.primary_dark

        MDLabel:
            text: root.device_brand
            font_style:
            theme_text_color: 'Custom'
            font_style: 'Overline'
            text_color: app.theme_cls.primary_dark

        MDLabel:
            text: root.device_status
            theme_text_color: 'Custom'
            font_style: 'Overline'
            text_color: app.theme_cls.primary_dark

    MDIconButton:
        id: check_button
        size_hint: (.2, 1)
        icon: 'check'
        icon_size: dp(32)
        radius: [self.height / 2, ]
        theme_text_color: 'Custom'
        text_color: app.theme_cls.primary_dark
        on_release: app.root.get_screen('home_screen').transfer_device(root)
###

<HomeScreen>:
    id: home_screen

    MDFloatLayout:
        md_bg_color: 'white'

        MDBoxLayout:
            size_hint: (1, .1)
            pos_hint: {'x': .0, 'y': .9}
            padding: [dp(5), dp(0)]
            spacing: dp(5)

            canvas:
                Color:
                    rgba: (0, 0, 0, .1)
                Line:
                    rectangle: [self.x, self.y, self.width, self.height]
                    width: dp(5)
                Color:
                    rgba: (48/255, 63/255, 159/255, 1)
                Rectangle:
                    pos: self.pos
                    size: self.size

            Image:
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                size_hint: (None, None)
                size: (dp(48), self.parent.height)
                source: "media/logo-bgwhite.png"
                fit_mode: "scale-down"

            MDLabel:
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                size_hint: (None, None)
                size: (dp(72), dp(48))
                text: "Manage:"
                bold: True
                font_style: "JetBrainsMono"
                theme_text_color: 'Custom'
                text_color: "white"

            MDRaisedButton:
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                size_hint: (None, None)
                size: (dp(80), dp(48))
                md_bg_color: "white"
                text: "Users"
                font_name: "JetBrainsMono"
                font_style: "Button"
                text_color: app.theme_cls.primary_dark
                line_color: "grey"
                color: "black"
                shorten: True

            MDRaisedButton:
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                size_hint: (None, None)
                size: (dp(128), dp(80))
                md_bg_color: "white"
                text: "Customers"
                font_name: "JetBrainsMono"
                font_style: "Button"
                text_color: app.theme_cls.primary_dark
                line_color: "grey"
                color: "black"
                shorten: True

            MDRaisedButton:
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                size_hint: (None, None)
                size: (dp(128), dp(48))
                md_bg_color: "white"
                text: "Devices"
                font_name: "JetBrainsMono"
                font_style: "Button"
                text_color: app.theme_cls.primary_dark
                line_color: "grey"
                color: "black"
                shorten: True

            MDRaisedButton:
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                size_hint: (None, None)
                size: (dp(128), dp(48))
                md_bg_color: "white"
                text: "Reports"
                font_name: "JetBrainsMono"
                font_style: "Button"
                text_color: app.theme_cls.primary_dark
                line_color: "grey"
                color: "black"
                shorten: True

            MDBoxLayout:
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}

                canvas:
                    Color:
                        rgba: (1, 1, 1, 1)

                    RoundedRectangle:
                        pos: (self.x, self.y + dp(10))
                        size: (self.width, self.parent.height - dp(20))
                        radius: [4, 4, 4, 4]

            MDLabel:
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                size_hint: (None, None)
                size: (dp(72), dp(48))
                text: "Logout:"
                bold: True
                font_style: "JetBrainsMono"
                theme_text_color: 'Custom'
                text_color: "white"

            MDFloatingActionButton:
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                #size_hint: (0.1, 1)
                md_bg_color: "white"
                type: "standard"
                icon: "logout-variant"
                icon_size: dp(32)
                radius: [self.height / 2, ]
                theme_text_color: 'Custom'
                text_color: app.theme_cls.primary_dark

        MDBoxLayout:
            size_hint: (.2, .9)
            pos_hint: {'x': .0, 'y': 0}
            padding: [dp(10), dp(10)]

            BorderBox:
                size_hint: (1, 1)
                pos_hint: {'x': 0, 'y': 0}

                MDIcon:
                    pos: (self.parent.x + dp(4), self.parent.y + self.parent.height - dp(36))
                    font_size: dp(32)
                    icon: 'timer-sand'
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                MDLabel:
                    pos: (self.parent.x + dp(40), self.parent.y + self.parent.height - self.height - dp(4))
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    text: "Pending"
                    bold: True
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                ScrollView:
                    pos: (self.parent.x, self.parent.y)
                    size_hint: (None, None)
                    size: (self.parent.width, (self.parent.y + self.parent.height - dp(50)))
                    padding: [dp(10), dp(10)]
                    scroll_type: ['bars', 'content']
                    bar_width: 3
                    bar_color: app.theme_cls.primary_dark

                    GridLayout:
                        id: pending_container
                        cols: 1
                        padding: dp(10)
                        spacing: dp(5)
                        size_hint_y: None
                        height: self.minimum_height

        MDBoxLayout:
            size_hint: (.6, .9)
            pos_hint: {'x': .2, 'y': 0}
            padding: [dp(10), dp(10)]
            spacing: dp(10)

            BorderBox:
                size_hint: (0.5, 1)
                pos_hint: {'x': 0, 'y': 0}

                MDIcon:
                    pos: (self.parent.x + dp(4), self.parent.y + self.parent.height - dp(36))
                    font_size: dp(32)
                    icon: 'account-plus'
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                MDLabel:
                    pos: (self.parent.x + dp(40), self.parent.y + self.parent.height - self.height - dp(4))
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    text: "Client"
                    bold: True
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                MDIconButton:
                    pos: ((self.parent.x + self.parent.width - dp(64)), (self.parent.y + self.parent.height - dp(106)))
                    size_hint: (None, None)
                    icon: 'file-search'
                    icon_size: dp(32)
                    radius: [self.height / 2, ]
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                MDLabel:
                    pos: ((self.parent.x + dp(16)), (self.parent.y + self.parent.height - dp(150)))
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    text: 'First Name:'
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                BorderTextInput:
                    id: client_first_name
                    pos: ((self.parent.x + dp(160)), (self.parent.y + self.parent.height - dp(150)))
                    size_hint: (None, None)
                    size: (self.parent.width - dp(176), dp(32))

                MDLabel:
                    pos: ((self.parent.x + dp(16)), (self.parent.y + self.parent.height - dp(198)))
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    text: 'Last Name:'
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                BorderTextInput:
                    id: client_last_name
                    size_hint: (None, None)
                    size: (self.parent.width - dp(176), dp(32))
                    pos: (self.parent.x + dp(160), self.parent.y + self.parent.height - dp(198))

                MDLabel:
                    pos: ((self.parent.x + dp(16)), (self.parent.y + self.parent.height - dp(246)))
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    text: 'Phone Number:'
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                BorderTextInput:
                    id: client_phone_number
                    size_hint: (None, None)
                    size: (self.parent.width - dp(176), dp(32))
                    pos: (self.parent.x + dp(160), self.parent.y + self.parent.height - dp(246))

                MDLabel:
                    pos: ((self.parent.x + dp(16)), (self.parent.y + self.parent.height - dp(294)))
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    text: 'email:'
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                BorderTextInput:
                    id: client_email
                    size_hint: (None, None)
                    size: (self.parent.width - dp(176), dp(32))
                    pos: (self.parent.x + dp(160), self.parent.y + self.parent.height - dp(294))
                    line_anim: False
                    cursor_color: app.theme_cls.primary_dark

                MDRectangleFlatIconButton:
                    pos: ((self.parent.x + self.parent.width - self.width - dp(16)), (self.parent.y + dp(16)))
                    size_hint: (0.25, 0.05)
                    md_bg_color: app.theme_cls.primary_dark
                    icon: "content-save"
                    text: "save"
                    font_style: "Button"
                    theme_text_color: "Custom"
                    text_color: "white"
                    line_color: "darkgrey"
                    theme_icon_color: "Custom"
                    icon_color: "white"
                    on_release: root.test_button()

            BorderBox:
                #md_bg_color: 'green'
                size_hint: (0.5, 1)
                pos_hint: {'x': 0.5, 'y': 0}

                MDIcon:
                    pos: (self.parent.x + dp(4), self.parent.y + self.parent.height - dp(36))
                    font_size: dp(32)
                    icon: 'devices'
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                MDLabel:
                    pos: (self.parent.x + dp(40), self.parent.y + self.parent.height - self.height - dp(4))
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    text: "Devices"
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                MDIconButton:
                    #md_bg_color: (0, 0, 0, 0.2)
                    size_hint: (None, None)
                    #size: (dp(100), dp(100))
                    pos: ((self.parent.x + self.parent.width - dp(64)), (self.parent.y + self.parent.height - dp(106)))
                    icon: 'file-search'
                    icon_size: dp(32)
                    radius: [self.height / 2, ]
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                MDLabel:
                    text: 'Device Type:'
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    pos: ((self.parent.x + dp(16)), (self.parent.y + self.parent.height - dp(150)))

                MySpinner:
                    id: device_type
                    size_hint: (None, None)
                    size: (self.parent.width - dp(167), dp(32))
                    pos: (self.parent.x + dp(160), self.parent.y + self.parent.height - dp(150))
                    values: ['Mobile', 'PC', 'Tablet']
                    text: "Choose Type"

                MDLabel:
                    text: 'Device Brand:'
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    pos: ((self.parent.x + dp(16)), (self.parent.y + self.parent.height - dp(198)))

                MySpinner:
                    id: device_brand
                    size_hint: (None, None)
                    size: (self.parent.width - dp(167), dp(32))
                    pos: (self.parent.x + dp(160), self.parent.y + self.parent.height - dp(198))
                    values: ['Samsung', 'Huawei', 'Oppo', 'Xiaomi', 'Iphone', 'Nokia']
                    text: "Choose brand"

                MDLabel:
                    text: 'Device Model:'
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    pos: ((self.parent.x + dp(16)), (self.parent.y + self.parent.height - dp(246)))

                BorderTextInput:
                    id: device_model
                    size_hint: (None, None)
                    size: (self.parent.width - dp(167), dp(32))
                    pos: (self.parent.x + dp(160), self.parent.y + self.parent.height - dp(246))

                MDLabel:
                    text: "Fault Type:"
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    pos: ((self.parent.x + dp(16)), (self.parent.y + self.parent.height - dp(294)))

                MySpinner:
                    id: fault_type
                    size_hint: (None, None)
                    size: (self.parent.width - dp(167), dp(32))
                    pos: (self.parent.x + dp(160), self.parent.y + self.parent.height - dp(294))
                    values: ['Hardware', 'Firmware']
                    on_text: root.configure_device_information_entry(self.text)

                MDLabel:
                    text: "Fault Code:"
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    pos: ((self.parent.x + dp(16)), (self.parent.y + self.parent.height - dp(342)))

                MySpinner:
                    id: fault_code
                    size_hint: (None, None)
                    size: (self.parent.width - dp(167), dp(32))
                    pos: (self.parent.x + dp(160), self.parent.y + self.parent.height - dp(342))
                    values: ['HF01: Microphone Problem', 'HF02: Speaker Problem']

                MDLabel:
                    text: 'Fault Level:'
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark
                    size_hint: (None, None)
                    size: (dp(144), dp(32))
                    pos: ((self.parent.x + dp(16)), (self.parent.y + self.parent.height - dp(390)))

                MySpinner:
                    id: fault_level
                    size_hint: (None, None)
                    size: (self.parent.width - dp(167), dp(32))
                    pos: (self.parent.x + dp(160), self.parent.y + self.parent.height - dp(390))
                    values: ['Critical', 'Major', 'Minor']

                MDRectangleFlatIconButton:
                    pos: ((self.parent.x + self.parent.width - self.width - dp(16)), (self.parent.y + dp(16)))
                    size_hint: (0.25, 0.05)
                    md_bg_color: app.theme_cls.primary_dark
                    icon: "content-save"
                    text: "save"
                    theme_text_color: "Custom"
                    text_color: "white"
                    line_color: "darkgrey"
                    theme_icon_color: "Custom"
                    icon_color: "white"
                    on_release: root.register_device()


        MDBoxLayout:
            size_hint: (.2, .9)
            pos_hint: {'x': .8, 'y': 0}
            padding: [dp(10), dp(10)]

            BorderBox:
                size_hint: (1, 1)
                pos_hint: {'x': 0, 'y': 0}

                MDIcon:
                    pos: (self.parent.x + dp(4), self.parent.y + self.parent.height - dp(36))
                    font_size: dp(32)
                    icon: 'timer-sand-complete'
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                MDLabel:
                    pos: (self.parent.x + dp(40), self.parent.y + self.parent.height - self.height - dp(4))
                    size_hint: (None, None)
                    size: (dp(128), dp(32))
                    text: "Complete"
                    font_style: "JetBrainsMono"
                    theme_text_color: 'Custom'
                    text_color: app.theme_cls.primary_dark

                ScrollView:
                    pos: (self.parent.x, self.parent.y)
                    size_hint: (None, None)
                    size: (self.parent.width, (self.parent.y + self.parent.height - dp(50)))
                    padding: [dp(10), dp(10)]
                    scroll_type: ['bars', 'content']
                    bar_width: 3
                    bar_color: app.theme_cls.primary_dark

                    GridLayout:
                        id: complete_container
                        cols: 1
                        padding: dp(10)
                        spacing: dp(5)
                        size_hint_y: None
                        height: self.minimum_height